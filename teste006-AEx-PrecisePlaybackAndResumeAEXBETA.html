<!DOCTYPE html>
<html>
	<head>
		<script src="AExLib/bufferLoaderAEx.js"></script>
		<script src="AExLib/initAudioContextAEx.js"></script>
		<script src="AExLib/initializeFilesPlayerAEx.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<link rel="stylesheet" href="JQuery/jquery-ui-themes-1.12.1/themes/base/jquery-ui.css">
	  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
	  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

		<script>
			$(function() {
				$("#botaoPlay, #botaoPause").button();
			} );

			$(document).ready(function(){
	    	$("#botaoPlay").prop("disabled", false);
				$("#botaoPause").prop("disabled", false);
			});
		</script>

	</head>
	<body>
		<script>
			console.log('Start');

			// Enter the address of the files
			var files = [ 'C4.wav'];//, 'C3.wav'];

			// Enter the start (in seconds) of the files
			var startTimeFiles = [ 0];//, 0];

			window.onload = initializeExample006(files, startTimeFiles);

			var context;
			var bLoader
			function initializeExample006() {
				context = initAudioContextAEx();
				console.log(context);
				bLoader = new bufferLoaderAEx( context, files, startTimeFiles, habilitarOsBotoes);
				bLoader.load();
			}

			function habilitarOsBotoes() {
				$('#botaoPlay').removeAttr('disabled');
				$('#botaoPause').removeAttr('disabled');
				console.log('habilita');
			}

			var startOffset = 0;
			var startTime = 0;

			var source;
			function play() {
				$("#botaoPlay").focus();
				console.log('PLAY');
				console.log(context);
				startTime = context.currentTime;

				source = context.createBufferSource();

				// Connect graph
				source.buffer = bLoader.bufferList[0];
				source.loop = true;
				source.connect(context.destination);
				// Start playback, but make sure we stay in bound of the buffer.
				source.start(0, startOffset % bLoader.bufferList[0].duration);
				$("#botaoPlay").prop("disabled", true);
				$('#botaoPause').removeAttr('disabled');
			}

			function pause() {
				console.log('PAUSE');
				source.stop();
				// Measure how much time passed since the last pause.
				startOffset += context.currentTime - startTime;
				$("#botaoPause").prop("disabled", true);
				$('#botaoPlay').removeAttr('disabled');
			}

		</script>

		<input id="botaoPlay" class="ui-button ui-widget ui-corner-all" type="submit" value="Play" onclick="play();">
		<input id="botaoPause" class="ui-button ui-widget ui-corner-all" type="submit" value="Pause" onclick="pause();">

	</body>
</html>
